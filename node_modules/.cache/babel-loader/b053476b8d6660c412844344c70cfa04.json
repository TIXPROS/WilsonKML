{"ast":null,"code":"import _regeneratorRuntime from\"/root/Bureau/Parser/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/root/Bureau/Parser/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/root/Bureau/Parser/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/root/Bureau/Parser/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/root/Bureau/Parser/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/root/Bureau/Parser/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/root/Bureau/Parser/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{Backdrop,Button,CircularProgress,Input,InputLabel,MenuItem,Select,Typography}from'@material-ui/core';import React,{Component}from'react';import{findVariableName,findVariableUnit}from'../constants/variableName';//Importation des fonctions permettant de retrouver les noms et les unités des variables \nimport{findGroup}from\"../constants/unityConvert\";import{convert}from\"./Parser\";//Importation de l'extracteur redéfnie\nimport{filter}from\"../constants/filter\";//Importation de la fonction permettant de filtrer\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var sectionTitles=[\"All\",\"Wind\",\"Wind speed threshold\",\"Wind gusts 1h\",\"Wind gusts 3h\",\"Temperature\",\"Visibility\"];var Location=[{id:\"06451\",Name:\"EBBR\",FicKML:\"MOSMIX_LATEST_06451.kml\"},{id:\"06450\",Name:\"EBAW\",FicKML:\"MOSMIX_LATEST_06450.kml\"},{id:\"06449\",Name:\"EBCI\",FicKML:\"MOSMIX_LATEST_06449.kml\"},{id:\"06478\",Name:\"EBLG\",FicKML:\"MOSMIX_LATEST_06478.kml\"},{id:\"06407\",Name:\"EBOS\",FicKML:\"MOSMIX_LATEST_06407.kml\"}];var Main=/*#__PURE__*/function(_Component){_inherits(Main,_Component);var _super=_createSuper(Main);function Main(props){var _this;_classCallCheck(this,Main);_this=_super.call(this,props);_this.loadFolder=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var folder,filterKML,firstLocationName;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:folder=e.target.files;filterKML=_toConsumableArray(folder).filter(function(el){return el.type===\"application/vnd.google-earth.kml+xml\";});firstLocationName=Location.find(function(el){return el.FicKML===filterKML[0].name;});_this.setState({files:filterKML,currentLocation:firstLocationName.Name},function(){_this.showFile(filterKML[0]);});case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.state={filed:false,//Controleur de l'existence d'un fichier chargé\ndata:[],//les lignes de données\ndays:[],//les jours\nfinale:[],//données compilées\nkeys:[],//les variables (PPPP et autres)\nloading:false,//Controleur du chargement de la page\nsupp:null,//Données suppléméntaires de locations,\nfilter:\"All\",current:{},files:null,currentLocation:\"EBBR\"};return _this;}//Fonction de récupération de fichier en texte\n_createClass(Main,[{key:\"showFile\",value:function(){var _showFile=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(file){var _this2=this;var reader;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:reader=new FileReader();reader.onload=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var text,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:text=e.target.result;data=convert(text);// console.log(data);\nif(data.data){_this2.setState({data:data.data,filed:true,supp:data.supp});}else{_this2.setState({filed:false});}case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x3){return _ref2.apply(this,arguments);};}();reader.readAsText(file);case 3:case\"end\":return _context3.stop();}}},_callee3);}));function showFile(_x2){return _showFile.apply(this,arguments);}return showFile;}()//chargement des fichiers du dossier\n},{key:\"range\",value://Fonction de compilation des données\nfunction(){var _range=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var _this3=this;var days,final;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return new Promise(function(r){return setTimeout(r,2000);});case 2:days=[];final=[];this.state.data.forEach(function(element){var existed=days.indexOf(element.date.split('T')[0]);if(existed===-1){var dayTMP=element.date.split('T')[0];days.push(dayTMP);}});this.setState({days:days},function(){//Extraction du Jour/Mois/Années des dates\ndays.forEach(function(element){var filteredHour=_this3.state.data.filter(function(el){return el.date.split('T')[0]===element;});var tmp={};tmp['date']=element;tmp[\"values\"]=filteredHour;final.push(tmp);});_this3.setState({finale:final,keys:Object.keys(final[0].values[0].values),loading:false});});case 6:case\"end\":return _context4.stop();}}},_callee4,this);}));function range(){return _range.apply(this,arguments);}return range;}()//Rendu visuel\n},{key:\"render\",value:function render(){var _this4=this;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h3\",component:\"h2\",children:\"Convertisseur Kml to JS\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Input,{type:\"file\",onChange:function onChange(e){return _this4.loadFolder(e);},inputProps:{webkitdirectory:\"\",directory:\"\",style:{height:30}},style:{marginTop:20}})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{title:\"Valider\",onClick:function onClick(){if(_this4.state.filed){_this4.setState({loading:true},function(){_this4.range();});}else{alert('Veuillez choisir un fichier à convertir');}},color:\"primary\",variant:\"contained\",style:{marginTop:10,marginBottom:10},children:\"Valider\"}),/*#__PURE__*/_jsx(\"div\",{children:this.state.loading&&/*#__PURE__*/_jsx(Backdrop/*className={classes.backdrop}*/,{open:this.state.loading,style:{zIndex:1500},children:/*#__PURE__*/_jsx(CircularProgress,{color:\"secondary\"})})}),/*#__PURE__*/_jsxs(\"div\",{children:[this.state.finale.length>0&&this.state.filed&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{margin:20},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"row\"},children:[/*#__PURE__*/_jsx(Typography,{style:{fontWeight:'bold',marginRight:5},children:\"Origin : \"}),/*#__PURE__*/_jsx(Typography,{children:this.state.currentLocation})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"row\"},children:[/*#__PURE__*/_jsx(Typography,{style:{fontWeight:'bold',marginRight:5},children:\"Issuer : \"}),/*#__PURE__*/_jsx(Typography,{children:this.state.supp.issuer}),/*#__PURE__*/_jsx(Typography,{style:{fontWeight:'bold',marginRight:5,marginLeft:20},children:\"ProductID : \"}),/*#__PURE__*/_jsx(Typography,{children:this.state.supp.productID}),/*#__PURE__*/_jsx(Typography,{style:{fontWeight:'bold',marginRight:5,marginLeft:20},children:\"IssueTime : \"}),/*#__PURE__*/_jsx(Typography,{children:this.state.supp.issueTime})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"row\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:styles.selector,children:[/*#__PURE__*/_jsx(InputLabel,{id:\"label\",children:\"Location\"}),/*#__PURE__*/_jsx(Select,{labelId:\"label\",id:\"select\",value:this.state.currentLocation,onChange:function onChange(val){_this4.setState({currentLocation:val.target.value},function(){var name=Location.find(function(el){return el.Name===val.target.value;});var file=_this4.state.files.find(function(el){return el.name===name.FicKML;});_this4.showFile(file);if(_this4.state.filed){_this4.setState({loading:true},function(){_this4.range();});}else{alert('Veuillez choisir un fichier à convertir');}});},children:Location.map(function(el,index){return/*#__PURE__*/_jsx(MenuItem,{value:el.Name,children:el.Name},index);})})]}),/*#__PURE__*/_jsxs(\"div\",{style:styles.selector,children:[/*#__PURE__*/_jsx(InputLabel,{id:\"label\",children:\"Parameter group\"}),/*#__PURE__*/_jsx(Select,{labelId:\"label\",id:\"select\",value:this.state.filter,onChange:function onChange(val){_this4.setState({filter:val.target.value});},children:sectionTitles.map(function(el,index){return/*#__PURE__*/_jsx(MenuItem,{value:el,children:el},index);})})]})]})]}),this.state.finale.length>0&&this.state.filed&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#1a8cff',width:330,height:55,position:\"absolute\",zIndex:1111,left:\"2%\"}}),/*#__PURE__*/_jsxs(\"table\",{style:{display:\"block\",maxHeight:600,overflowY:\"scroll\",overflowX:\"scroll\",maxWidth:\"96%\",marginLeft:\"2%\",position:'relative'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[this.state.finale.length>0&&this.state.filed&&/*#__PURE__*/_jsx(\"th\",{style:{top:0}}),this.state.finale.map(function(_el){return _el.values.map(function(el,id){return/*#__PURE__*/_jsxs(\"th\",{style:{top:0},children:[_el.date.slice(8,10),/*#__PURE__*/_jsx(\"br\",{}),el.date.split('T')[1].slice(0,2)+\"Z\"]},id);});})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filter(this.state.filter,this.state.keys).map(function(elem,ind){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{style:{left:0,position:\"sticky\",backgroundColor:\"#1a8cff\"},children:/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'bold',color:\"#fff\",width:300},children:findVariableName(elem)===false?elem:findVariableName(elem)+\"\\n(\"+findVariableUnit(elem)+\")\"})}),_this4.state.finale.map(function(_el){return _el.values.map(function(el,i){return/*#__PURE__*/_jsx(\"td\",{onClick:function onClick(){_this4.setState({current:{id:i,variable:elem}});},style:{cursor:\"pointer\",backgroundColor:(i===_this4.state.current.id||elem===_this4.state.current.variable)&&\"#70b7ff\"},children:el.values[elem]===\"-\"?\"N/A\":findGroup(elem,el.values[elem])},i);});})]},ind);})})]}),/*#__PURE__*/_jsx(Typography,{style:{textAlign:'left',marginLeft:'2%'},children:\"Showing 1 to \"+this.state.keys.length+\" of \"+this.state.keys.length+\" pages\"})]})]})]});}}]);return Main;}(Component);var styles={selector:{displey:\"flex\",flexDirection:'row',margin:15}};export default Main;","map":{"version":3,"sources":["/root/Bureau/Parser/src/components/ClientMain.js"],"names":["Backdrop","Button","CircularProgress","Input","InputLabel","MenuItem","Select","Typography","React","Component","findVariableName","findVariableUnit","findGroup","convert","filter","sectionTitles","Location","id","Name","FicKML","Main","props","loadFolder","e","folder","target","files","filterKML","el","type","firstLocationName","find","name","setState","currentLocation","showFile","state","filed","data","days","finale","keys","loading","supp","current","file","reader","FileReader","onload","text","result","readAsText","Promise","r","setTimeout","final","forEach","element","existed","indexOf","date","split","dayTMP","push","filteredHour","tmp","Object","values","webkitdirectory","directory","style","height","marginTop","range","alert","marginBottom","zIndex","length","margin","display","flexDirection","fontWeight","marginRight","issuer","marginLeft","productID","issueTime","styles","selector","val","value","map","index","backgroundColor","width","position","left","maxHeight","overflowY","overflowX","maxWidth","top","_el","slice","elem","ind","color","i","variable","cursor","textAlign","displey"],"mappings":"27BAAA,OAASA,QAAT,CAAmBC,MAAnB,CAA2BC,gBAA3B,CAA6CC,KAA7C,CAAoDC,UAApD,CAAgEC,QAAhE,CAA0EC,MAA1E,CAAkFC,UAAlF,KAAoG,mBAApG,CACA,MAAOC,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,gBAAT,CAA2BC,gBAA3B,KAAmD,2BAAnD,CAA+E;AAC/E,OAASC,SAAT,KAA0B,2BAA1B,CAEA,OAASC,OAAT,KAAwB,UAAxB,CAAmC;AACnC,OAASC,MAAT,KAAuB,qBAAvB,CAA6C;wFAG7C,GAAMC,CAAAA,aAAa,CAAG,CAClB,KADkB,CAElB,MAFkB,CAGlB,sBAHkB,CAIlB,eAJkB,CAKlB,eALkB,CAMlB,aANkB,CAOlB,YAPkB,CAAtB,CASA,GAAMC,CAAAA,QAAQ,CAAG,CACb,CAAEC,EAAE,CAAE,OAAN,CAAeC,IAAI,CAAE,MAArB,CAA6BC,MAAM,CAAE,yBAArC,CADa,CAEb,CAAEF,EAAE,CAAE,OAAN,CAAeC,IAAI,CAAE,MAArB,CAA6BC,MAAM,CAAE,yBAArC,CAFa,CAGb,CAAEF,EAAE,CAAE,OAAN,CAAeC,IAAI,CAAE,MAArB,CAA6BC,MAAM,CAAE,yBAArC,CAHa,CAIb,CAAEF,EAAE,CAAE,OAAN,CAAeC,IAAI,CAAE,MAArB,CAA6BC,MAAM,CAAE,yBAArC,CAJa,CAKb,CAAEF,EAAE,CAAE,OAAN,CAAeC,IAAI,CAAE,MAArB,CAA6BC,MAAM,CAAE,yBAArC,CALa,CAAjB,C,GAQMC,CAAAA,I,4FAEF,cAAYC,KAAZ,CAAmB,sCACf,uBAAMA,KAAN,EADe,MAoCnBC,UApCmB,0FAoCN,iBAAOC,CAAP,yJACLC,MADK,CACID,CAAC,CAACE,MAAF,CAASC,KADb,CAELC,SAFK,CAEO,mBAAIH,MAAJ,EAAYV,MAAZ,CAAmB,SAACc,EAAD,QAASA,CAAAA,EAAE,CAACC,IAAH,GAAY,sCAArB,EAAnB,CAFP,CAMLC,iBANK,CAMed,QAAQ,CAACe,IAAT,CAAc,SAACH,EAAD,QAASA,CAAAA,EAAE,CAACT,MAAH,GAAcQ,SAAS,CAAC,CAAD,CAAT,CAAaK,IAApC,EAAd,CANf,CAQT,MAAKC,QAAL,CAAc,CAAEP,KAAK,CAAEC,SAAT,CAAoBO,eAAe,CAAEJ,iBAAiB,CAACZ,IAAvD,CAAd,CAA6E,UAAM,CAC/E,MAAKiB,QAAL,CAAcR,SAAS,CAAC,CAAD,CAAvB,EACH,CAFD,EARS,sDApCM,+DAEf,MAAKS,KAAL,CAAa,CACTC,KAAK,CAAE,KADE,CACK;AACdC,IAAI,CAAE,EAFG,CAEC;AACVC,IAAI,CAAE,EAHG,CAGC;AACVC,MAAM,CAAE,EAJC,CAIG;AACZC,IAAI,CAAE,EALG,CAKC;AACVC,OAAO,CAAE,KANA,CAMO;AAChBC,IAAI,CAAE,IAPG,CAOG;AACZ7B,MAAM,CAAE,KARC,CAST8B,OAAO,CAAE,EATA,CAUTlB,KAAK,CAAE,IAVE,CAWTQ,eAAe,CAAE,MAXR,CAAb,CAFe,aAelB,CAED;0HACA,kBAAeW,IAAf,iJAEUC,MAFV,CAEmB,GAAIC,CAAAA,UAAJ,EAFnB,CAGID,MAAM,CAACE,MAAP,2FAAgB,kBAAOzB,CAAP,oIACN0B,IADM,CACE1B,CAAC,CAACE,MAAF,CAASyB,MADX,CAERZ,IAFQ,CAEDzB,OAAO,CAACoC,IAAD,CAFN,CAGZ;AACA,GAAIX,IAAI,CAACA,IAAT,CAAe,CACX,MAAI,CAACL,QAAL,CAAc,CAAEK,IAAI,CAAEA,IAAI,CAACA,IAAb,CAAmBD,KAAK,CAAE,IAA1B,CAAgCM,IAAI,CAAEL,IAAI,CAACK,IAA3C,CAAd,EACH,CAFD,IAEO,CACH,MAAI,CAACV,QAAL,CAAc,CAAEI,KAAK,CAAE,KAAT,CAAd,EACH,CARW,wDAAhB,iEAWAS,MAAM,CAACK,UAAP,CAAkBN,IAAlB,EAdJ,wD,qFAiBA;qBAgBA;8EACA,8LACU,IAAIO,CAAAA,OAAJ,CAAY,SAAAC,CAAC,QAAIC,CAAAA,UAAU,CAACD,CAAD,CAAI,IAAJ,CAAd,EAAb,CADV,QAEQd,IAFR,CAEe,EAFf,CAGQgB,KAHR,CAGgB,EAHhB,CAII,KAAKnB,KAAL,CAAWE,IAAX,CAAgBkB,OAAhB,CAAwB,SAAAC,OAAO,CAAI,CAC/B,GAAIC,CAAAA,OAAO,CAAGnB,IAAI,CAACoB,OAAL,CAAaF,OAAO,CAACG,IAAR,CAAaC,KAAb,CAAmB,GAAnB,EAAwB,CAAxB,CAAb,CAAd,CAEA,GAAIH,OAAO,GAAK,CAAC,CAAjB,CAAoB,CAChB,GAAII,CAAAA,MAAM,CAAGL,OAAO,CAACG,IAAR,CAAaC,KAAb,CAAmB,GAAnB,EAAwB,CAAxB,CAAb,CACAtB,IAAI,CAACwB,IAAL,CAAUD,MAAV,EACH,CACJ,CAPD,EAQA,KAAK7B,QAAL,CAAc,CACVM,IAAI,CAAEA,IADI,CAAd,CAEG,UAAM,CACL;AACAA,IAAI,CAACiB,OAAL,CAAa,SAACC,OAAD,CAAa,CACtB,GAAIO,CAAAA,YAAY,CAAG,MAAI,CAAC5B,KAAL,CAAWE,IAAX,CAAgBxB,MAAhB,CAAuB,SAACc,EAAD,QAAQA,CAAAA,EAAE,CAACgC,IAAH,CAAQC,KAAR,CAAc,GAAd,EAAmB,CAAnB,IAA0BJ,OAAlC,EAAvB,CAAnB,CACA,GAAIQ,CAAAA,GAAG,CAAG,EAAV,CACAA,GAAG,CAAC,MAAD,CAAH,CAAcR,OAAd,CACAQ,GAAG,CAAC,QAAD,CAAH,CAAgBD,YAAhB,CAEAT,KAAK,CAACQ,IAAN,CAAWE,GAAX,EACH,CAPD,EASA,MAAI,CAAChC,QAAL,CAAc,CAAEO,MAAM,CAAEe,KAAV,CAAiBd,IAAI,CAAEyB,MAAM,CAACzB,IAAP,CAAYc,KAAK,CAAC,CAAD,CAAL,CAASY,MAAT,CAAgB,CAAhB,EAAmBA,MAA/B,CAAvB,CAA+DzB,OAAO,CAAE,KAAxE,CAAd,EACH,CAdD,EAZJ,6D,yEA6BA;sBACA,iBAAS,iBAEL,mBACI,oCACI,KAAC,UAAD,EAAY,OAAO,CAAC,IAApB,CAAyB,SAAS,CAAC,IAAnC,qCADJ,cAEI,kCAEI,KAAC,KAAD,EAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAE,kBAACnB,CAAD,QAAO,CAAA,MAAI,CAACD,UAAL,CAAgBC,CAAhB,CAAP,EAA7B,CAAwD,UAAU,CAAE,CAAE6C,eAAe,CAAE,EAAnB,CAAuBC,SAAS,CAAE,EAAlC,CAAsCC,KAAK,CAAE,CAAEC,MAAM,CAAE,EAAV,CAA7C,CAApE,CAAmI,KAAK,CAAE,CAAEC,SAAS,CAAE,EAAb,CAA1I,EAFJ,EAFJ,cAMI,aANJ,cAOI,KAAC,MAAD,EACI,KAAK,CAAC,SADV,CAEI,OAAO,CAAE,kBAAM,CACX,GAAI,MAAI,CAACpC,KAAL,CAAWC,KAAf,CAAsB,CAClB,MAAI,CAACJ,QAAL,CAAc,CAAES,OAAO,CAAE,IAAX,CAAd,CAAiC,UAAM,CAAE,MAAI,CAAC+B,KAAL,GAAc,CAAvD,EACH,CAFD,IAEO,CACHC,KAAK,CAAC,yCAAD,CAAL,CACH,CACJ,CARL,CASI,KAAK,CAAC,SATV,CAUI,OAAO,CAAC,WAVZ,CAWI,KAAK,CAAE,CAAEF,SAAS,CAAE,EAAb,CAAiBG,YAAY,CAAE,EAA/B,CAXX,qBAPJ,cAqBI,qBAKQ,KAAKvC,KAAL,CAAWM,OAAX,eACA,KAAC,QAAS,gCAAV,EAA2C,IAAI,CAAE,KAAKN,KAAL,CAAWM,OAA5D,CAAqE,KAAK,CAAE,CAAEkC,MAAM,CAAE,IAAV,CAA5E,uBACI,KAAC,gBAAD,EAAkB,KAAK,CAAC,WAAxB,EADJ,EANR,EArBJ,cAiCI,uBAEQ,KAAKxC,KAAL,CAAWI,MAAX,CAAkBqC,MAAlB,CAA2B,CAA3B,EAAgC,KAAKzC,KAAL,CAAWC,KAA3C,eACA,oCACI,aAAK,KAAK,CAAE,CAAEyC,MAAM,CAAE,EAAV,CAAZ,wBACI,aAAK,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAX,CAAmBC,aAAa,CAAE,KAAlC,CAAZ,wBACI,KAAC,UAAD,EAAY,KAAK,CAAE,CAAEC,UAAU,CAAE,MAAd,CAAsBC,WAAW,CAAE,CAAnC,CAAnB,uBADJ,cAEI,KAAC,UAAD,WAAa,KAAK9C,KAAL,CAAWF,eAAxB,EAFJ,GADJ,cAKI,aAAK,KAAK,CAAE,CAAE6C,OAAO,CAAE,MAAX,CAAmBC,aAAa,CAAE,KAAlC,CAAZ,wBACI,KAAC,UAAD,EAAY,KAAK,CAAE,CAAEC,UAAU,CAAE,MAAd,CAAsBC,WAAW,CAAE,CAAnC,CAAnB,uBADJ,cAEI,KAAC,UAAD,WAAa,KAAK9C,KAAL,CAAWO,IAAX,CAAgBwC,MAA7B,EAFJ,cAGI,KAAC,UAAD,EAAY,KAAK,CAAE,CAAEF,UAAU,CAAE,MAAd,CAAsBC,WAAW,CAAE,CAAnC,CAAsCE,UAAU,CAAE,EAAlD,CAAnB,0BAHJ,cAII,KAAC,UAAD,WAAa,KAAKhD,KAAL,CAAWO,IAAX,CAAgB0C,SAA7B,EAJJ,cAKI,KAAC,UAAD,EAAY,KAAK,CAAE,CAAEJ,UAAU,CAAE,MAAd,CAAsBC,WAAW,CAAE,CAAnC,CAAsCE,UAAU,CAAE,EAAlD,CAAnB,0BALJ,cAMI,KAAC,UAAD,WAAa,KAAKhD,KAAL,CAAWO,IAAX,CAAgB2C,SAA7B,EANJ,GALJ,GADJ,cAkBI,aAAK,KAAK,CAAE,CAAEP,OAAO,CAAE,MAAX,CAAmBC,aAAa,CAAE,KAAlC,CAAZ,wBAEI,aAAK,KAAK,CAAEO,MAAM,CAACC,QAAnB,wBACI,KAAC,UAAD,EAAY,EAAE,CAAC,OAAf,sBADJ,cAEI,KAAC,MAAD,EAAQ,OAAO,CAAC,OAAhB,CAAwB,EAAE,CAAC,QAA3B,CAAoC,KAAK,CAAE,KAAKpD,KAAL,CAAWF,eAAtD,CACI,QAAQ,CAAE,kBAACuD,GAAD,CAAS,CACf,MAAI,CAACxD,QAAL,CAAc,CAAEC,eAAe,CAAEuD,GAAG,CAAChE,MAAJ,CAAWiE,KAA9B,CAAd,CAAqD,UAAM,CAEvD,GAAI1D,CAAAA,IAAI,CAAGhB,QAAQ,CAACe,IAAT,CAAc,SAACH,EAAD,QAASA,CAAAA,EAAE,CAACV,IAAH,GAAYuE,GAAG,CAAChE,MAAJ,CAAWiE,KAAhC,EAAd,CAAX,CACA,GAAI7C,CAAAA,IAAI,CAAG,MAAI,CAACT,KAAL,CAAWV,KAAX,CAAiBK,IAAjB,CAAsB,SAACH,EAAD,QAASA,CAAAA,EAAE,CAACI,IAAH,GAAYA,IAAI,CAACb,MAA1B,EAAtB,CAAX,CAEA,MAAI,CAACgB,QAAL,CAAcU,IAAd,EAEA,GAAI,MAAI,CAACT,KAAL,CAAWC,KAAf,CAAsB,CAClB,MAAI,CAACJ,QAAL,CAAc,CAAES,OAAO,CAAE,IAAX,CAAd,CAAiC,UAAM,CAAE,MAAI,CAAC+B,KAAL,GAAc,CAAvD,EACH,CAFD,IAEO,CACHC,KAAK,CAAC,yCAAD,CAAL,CACH,CACJ,CAZD,EAaH,CAfL,UAkBQ1D,QAAQ,CAAC2E,GAAT,CAAa,SAAC/D,EAAD,CAAKgE,KAAL,qBACT,KAAC,QAAD,EAAsB,KAAK,CAAEhE,EAAE,CAACV,IAAhC,UAAuCU,EAAE,CAACV,IAA1C,EAAe0E,KAAf,CADS,EAAb,CAlBR,EAFJ,GAFJ,cA6BI,aAAK,KAAK,CAAEL,MAAM,CAACC,QAAnB,wBACI,KAAC,UAAD,EAAY,EAAE,CAAC,OAAf,6BADJ,cAEI,KAAC,MAAD,EAAQ,OAAO,CAAC,OAAhB,CAAwB,EAAE,CAAC,QAA3B,CAAoC,KAAK,CAAE,KAAKpD,KAAL,CAAWtB,MAAtD,CAA8D,QAAQ,CAAE,kBAAC2E,GAAD,CAAS,CAAE,MAAI,CAACxD,QAAL,CAAc,CAAEnB,MAAM,CAAE2E,GAAG,CAAChE,MAAJ,CAAWiE,KAArB,CAAd,EAA6C,CAAhI,UAEQ3E,aAAa,CAAC4E,GAAd,CAAkB,SAAC/D,EAAD,CAAKgE,KAAL,qBACd,KAAC,QAAD,EAAsB,KAAK,CAAEhE,EAA7B,UAAkCA,EAAlC,EAAegE,KAAf,CADc,EAAlB,CAFR,EAFJ,GA7BJ,GAlBJ,GAHR,CAgEQ,KAAKxD,KAAL,CAAWI,MAAX,CAAkBqC,MAAlB,CAA2B,CAA3B,EAAgC,KAAKzC,KAAL,CAAWC,KAA3C,eAAoD,oCAEhD,YAAK,KAAK,CAAE,CAAEwD,eAAe,CAAE,SAAnB,CAA8BC,KAAK,CAAE,GAArC,CAA0CvB,MAAM,CAAE,EAAlD,CAAsDwB,QAAQ,CAAE,UAAhE,CAA4EnB,MAAM,CAAE,IAApF,CAA0FoB,IAAI,CAAE,IAAhG,CAAZ,EAFgD,cAIhD,eACI,KAAK,CAAE,CACHjB,OAAO,CAAE,OADN,CAEHkB,SAAS,CAAE,GAFR,CAGHC,SAAS,CAAE,QAHR,CAIHC,SAAS,CAAE,QAJR,CAKHC,QAAQ,CAAE,KALP,CAMHhB,UAAU,CAAE,IANT,CAOHW,QAAQ,CAAE,UAPP,CADX,wBAWI,oCACI,sBAEQ,KAAK3D,KAAL,CAAWI,MAAX,CAAkBqC,MAAlB,CAA2B,CAA3B,EAAgC,KAAKzC,KAAL,CAAWC,KAA3C,eACA,WAAI,KAAK,CAAE,CAAEgE,GAAG,CAAE,CAAP,CAAX,EAHR,CAMQ,KAAKjE,KAAL,CAAWI,MAAX,CAAkBmD,GAAlB,CAAsB,SAACW,GAAD,QAClBA,CAAAA,GAAG,CAACnC,MAAJ,CAAWwB,GAAX,CAAe,SAAC/D,EAAD,CAAKX,EAAL,qBACX,YAAI,KAAK,CAAE,CAAEoF,GAAG,CAAE,CAAP,CAAX,WACKC,GAAG,CAAC1C,IAAJ,CAAS2C,KAAT,CAAe,CAAf,CAAkB,EAAlB,CADL,cAC2B,aAD3B,CAEK3E,EAAE,CAACgC,IAAH,CAAQC,KAAR,CAAc,GAAd,EAAmB,CAAnB,EAAsB0C,KAAtB,CAA4B,CAA5B,CAA+B,CAA/B,EAAoC,GAFzC,GAA4BtF,EAA5B,CADW,EAAf,CADkB,EAAtB,CANR,GADJ,EAXJ,cA6BI,uBAEQH,MAAM,CAAC,KAAKsB,KAAL,CAAWtB,MAAZ,CAAoB,KAAKsB,KAAL,CAAWK,IAA/B,CAAN,CAA2CkD,GAA3C,CAA+C,SAACa,IAAD,CAAOC,GAAP,qBAC3C,mCACI,WAAI,KAAK,CAAE,CAAET,IAAI,CAAE,CAAR,CAAWD,QAAQ,CAAE,QAArB,CAA+BF,eAAe,CAAE,SAAhD,CAAX,uBACI,YAAK,KAAK,CAAE,CAAEZ,UAAU,CAAE,MAAd,CAAsByB,KAAK,CAAE,MAA7B,CAAqCZ,KAAK,CAAE,GAA5C,CAAZ,UACKpF,gBAAgB,CAAC8F,IAAD,CAAhB,GAA2B,KAA3B,CAAmCA,IAAnC,CAA2C9F,gBAAgB,CAAC8F,IAAD,CAAhB,CAAyB,KAAzB,CAAiC7F,gBAAgB,CAAC6F,IAAD,CAAjD,CAA0D,GAD1G,EADJ,EADJ,CAOQ,MAAI,CAACpE,KAAL,CAAWI,MAAX,CAAkBmD,GAAlB,CAAsB,SAACW,GAAD,QAClBA,CAAAA,GAAG,CAACnC,MAAJ,CAAWwB,GAAX,CAAe,SAAC/D,EAAD,CAAK+E,CAAL,qBACX,WAAI,OAAO,CAAE,kBAAM,CAAE,MAAI,CAAC1E,QAAL,CAAc,CAAEW,OAAO,CAAE,CAAE3B,EAAE,CAAE0F,CAAN,CAASC,QAAQ,CAAEJ,IAAnB,CAAX,CAAd,EAAuD,CAA5E,CAA8E,KAAK,CAAE,CAAEK,MAAM,CAAE,SAAV,CAAqBhB,eAAe,CAAE,CAACc,CAAC,GAAK,MAAI,CAACvE,KAAL,CAAWQ,OAAX,CAAmB3B,EAAzB,EAA+BuF,IAAI,GAAK,MAAI,CAACpE,KAAL,CAAWQ,OAAX,CAAmBgE,QAA5D,GAAyE,SAA/G,CAArF,UAA2NhF,EAAE,CAACuC,MAAH,CAAUqC,IAAV,IAAoB,GAApB,CAA0B,KAA1B,CAAkC5F,SAAS,CAAC4F,IAAD,CAAO5E,EAAE,CAACuC,MAAH,CAAUqC,IAAV,CAAP,CAAtQ,EAAsNG,CAAtN,CADW,EAAf,CADkB,EAAtB,CAPR,GAASF,GAAT,CAD2C,EAA/C,CAFR,EA7BJ,GAJgD,cAsDhD,KAAC,UAAD,EAAY,KAAK,CAAE,CAAEK,SAAS,CAAE,MAAb,CAAqB1B,UAAU,CAAE,IAAjC,CAAnB,UAA8D,gBAAkB,KAAKhD,KAAL,CAAWK,IAAX,CAAgBoC,MAAlC,CAA2C,MAA3C,CAAoD,KAAKzC,KAAL,CAAWK,IAAX,CAAgBoC,MAApE,CAA6E,QAA3I,EAtDgD,GAhE5D,GAjCJ,GADJ,CA8JH,C,kBApPcpE,S,EAuPnB,GAAM8E,CAAAA,MAAM,CAAG,CACXC,QAAQ,CAAE,CACNuB,OAAO,CAAE,MADH,CAEN/B,aAAa,CAAE,KAFT,CAGNF,MAAM,CAAE,EAHF,CADC,CAAf,CAQA,cAAe1D,CAAAA,IAAf","sourcesContent":["import { Backdrop, Button, CircularProgress, Input, InputLabel, MenuItem, Select, Typography } from '@material-ui/core';\nimport React, { Component } from 'react';\nimport { findVariableName, findVariableUnit } from '../constants/variableName' //Importation des fonctions permettant de retrouver les noms et les unités des variables \nimport { findGroup } from \"../constants/unityConvert\"\n\nimport { convert } from \"./Parser\";//Importation de l'extracteur redéfnie\nimport { filter } from \"../constants/filter\";//Importation de la fonction permettant de filtrer\n\n\nconst sectionTitles = [\n    \"All\",\n    \"Wind\",\n    \"Wind speed threshold\",\n    \"Wind gusts 1h\",\n    \"Wind gusts 3h\",\n    \"Temperature\",\n    \"Visibility\",\n];\nconst Location = [\n    { id: \"06451\", Name: \"EBBR\", FicKML: \"MOSMIX_LATEST_06451.kml\" },\n    { id: \"06450\", Name: \"EBAW\", FicKML: \"MOSMIX_LATEST_06450.kml\" },\n    { id: \"06449\", Name: \"EBCI\", FicKML: \"MOSMIX_LATEST_06449.kml\" },\n    { id: \"06478\", Name: \"EBLG\", FicKML: \"MOSMIX_LATEST_06478.kml\" },\n    { id: \"06407\", Name: \"EBOS\", FicKML: \"MOSMIX_LATEST_06407.kml\" }\n\n]\nclass Main extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            filed: false, //Controleur de l'existence d'un fichier chargé\n            data: [], //les lignes de données\n            days: [], //les jours\n            finale: [], //données compilées\n            keys: [], //les variables (PPPP et autres)\n            loading: false, //Controleur du chargement de la page\n            supp: null, //Données suppléméntaires de locations,\n            filter: \"All\",\n            current: {},\n            files: null,\n            currentLocation: \"EBBR\"\n        }\n    }\n\n    //Fonction de récupération de fichier en texte\n    async showFile(file) {\n\n        const reader = new FileReader()\n        reader.onload = async (e) => {\n            const text = (e.target.result)\n            var data = convert(text)\n            // console.log(data);\n            if (data.data) {\n                this.setState({ data: data.data, filed: true, supp: data.supp })\n            } else {\n                this.setState({ filed: false })\n            }\n\n        };\n        reader.readAsText(file)\n    }\n\n    //chargement des fichiers du dossier\n    loadFolder = async (e) => {\n        var folder = e.target.files\n        var filterKML = [...folder].filter((el) => (el.type === \"application/vnd.google-earth.kml+xml\"))\n\n\n\n        var firstLocationName = Location.find((el) => (el.FicKML === filterKML[0].name))\n\n        this.setState({ files: filterKML, currentLocation: firstLocationName.Name }, () => {\n            this.showFile(filterKML[0])\n        })\n\n    }\n\n\n    //Fonction de compilation des données\n    async range() {\n        await new Promise(r => setTimeout(r, 2000));\n        var days = []\n        var final = []\n        this.state.data.forEach(element => {\n            var existed = days.indexOf(element.date.split('T')[0])\n\n            if (existed === -1) {\n                var dayTMP = element.date.split('T')[0]\n                days.push(dayTMP)\n            }\n        });\n        this.setState({\n            days: days\n        }, () => {\n            //Extraction du Jour/Mois/Années des dates\n            days.forEach((element) => {\n                var filteredHour = this.state.data.filter((el) => el.date.split('T')[0] === element)\n                var tmp = {}\n                tmp['date'] = element;\n                tmp[\"values\"] = filteredHour\n\n                final.push(tmp);\n            });\n\n            this.setState({ finale: final, keys: Object.keys(final[0].values[0].values), loading: false })\n        })\n    }\n\n    //Rendu visuel\n    render() {\n\n        return (\n            <div>\n                <Typography variant=\"h3\" component=\"h2\">Convertisseur Kml to JS</Typography>\n                <div>\n                    {/* <Input type=\"file\" onChange={(e) => this.showFile(e)} inputProps={{ accept: '.xml,.kml', style: { height: 30 } }} style={{ marginTop: 20, }} /> */}\n                    <Input type=\"file\" onChange={(e) => this.loadFolder(e)} inputProps={{ webkitdirectory: \"\", directory: \"\", style: { height: 30 } }} style={{ marginTop: 20, }} />\n                </div>\n                <br />\n                <Button\n                    title='Valider'\n                    onClick={() => {\n                        if (this.state.filed) {\n                            this.setState({ loading: true }, () => { this.range() })\n                        } else {\n                            alert('Veuillez choisir un fichier à convertir')\n                        }\n                    }}\n                    color=\"primary\"\n                    variant=\"contained\"\n                    style={{ marginTop: 10, marginBottom: 10 }}\n                >Valider</Button>\n\n                <div>\n                    {/* {\n                        this.state.loading && <CircularProgress color=\"secondary\" style={{ marginTop: 15 }} />\n                    } */}\n                    {\n                        this.state.loading &&\n                        <Backdrop /*className={classes.backdrop}*/ open={this.state.loading} style={{ zIndex: 1500 }} >\n                            <CircularProgress color=\"secondary\" />\n                        </Backdrop>\n                    }\n                </div>\n\n                <div>\n                    {\n                        this.state.finale.length > 0 && this.state.filed &&\n                        <div>\n                            <div style={{ margin: 20 }} >\n                                <div style={{ display: \"flex\", flexDirection: \"row\" }} >\n                                    <Typography style={{ fontWeight: 'bold', marginRight: 5 }} >Origin : </Typography>\n                                    <Typography>{this.state.currentLocation}</Typography>\n                                </div>\n                                <div style={{ display: \"flex\", flexDirection: \"row\" }} >\n                                    <Typography style={{ fontWeight: 'bold', marginRight: 5, }} >Issuer : </Typography>\n                                    <Typography>{this.state.supp.issuer}</Typography>\n                                    <Typography style={{ fontWeight: 'bold', marginRight: 5, marginLeft: 20 }} >ProductID : </Typography>\n                                    <Typography>{this.state.supp.productID}</Typography>\n                                    <Typography style={{ fontWeight: 'bold', marginRight: 5, marginLeft: 20 }} >IssueTime : </Typography>\n                                    <Typography>{this.state.supp.issueTime}</Typography>\n                                    {/* <Typography style={{ fontWeight: 'bold', marginRight: 5, marginLeft: 20 }} >Origin : </Typography>\n                                    <Typography>EBBR</Typography> */}\n                                </div>\n                            </div>\n\n                            <div style={{ display: \"flex\", flexDirection: \"row\" }} >\n\n                                <div style={styles.selector} >\n                                    <InputLabel id=\"label\">Location</InputLabel>\n                                    <Select labelId=\"label\" id=\"select\" value={this.state.currentLocation}\n                                        onChange={(val) => {\n                                            this.setState({ currentLocation: val.target.value }, () => {\n\n                                                var name = Location.find((el) => (el.Name === val.target.value))\n                                                var file = this.state.files.find((el) => (el.name === name.FicKML))\n\n                                                this.showFile(file)\n\n                                                if (this.state.filed) {\n                                                    this.setState({ loading: true }, () => { this.range() })\n                                                } else {\n                                                    alert('Veuillez choisir un fichier à convertir')\n                                                }\n                                            })\n                                        }}\n                                    >\n                                        {\n                                            Location.map((el, index) => (\n                                                <MenuItem key={index} value={el.Name}>{el.Name}</MenuItem>\n                                            ))\n                                        }\n                                    </Select>\n                                </div>\n\n                                <div style={styles.selector} >\n                                    <InputLabel id=\"label\">Parameter group</InputLabel>\n                                    <Select labelId=\"label\" id=\"select\" value={this.state.filter} onChange={(val) => { this.setState({ filter: val.target.value }) }} >\n                                        {\n                                            sectionTitles.map((el, index) => (\n                                                <MenuItem key={index} value={el}>{el}</MenuItem>\n                                            ))\n                                        }\n                                    </Select>\n                                </div>\n                            </div>\n                        </div >\n                    }\n                    {\n                        this.state.finale.length > 0 && this.state.filed && <div\n                        >\n                            <div style={{ backgroundColor: '#1a8cff', width: 330, height: 55, position: \"absolute\", zIndex: 1111, left: \"2%\" }} ></div>\n\n                            <table\n                                style={{\n                                    display: \"block\",\n                                    maxHeight: 600,\n                                    overflowY: \"scroll\",\n                                    overflowX: \"scroll\",\n                                    maxWidth: \"96%\",\n                                    marginLeft: \"2%\",\n                                    position: 'relative'\n                                }}\n                            >\n                                <thead  >\n                                    <tr>\n                                        {\n                                            this.state.finale.length > 0 && this.state.filed &&\n                                            <th style={{ top: 0 }} ></th>\n                                        }\n                                        {\n                                            this.state.finale.map((_el) => (\n                                                _el.values.map((el, id) => (\n                                                    <th style={{ top: 0 }} key={id} >\n                                                        {_el.date.slice(8, 10)}<br />\n                                                        {el.date.split('T')[1].slice(0, 2) + \"Z\"}\n                                                    </th>\n                                                ))\n                                            ))\n                                        }\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {\n                                        filter(this.state.filter, this.state.keys).map((elem, ind) => (\n                                            <tr key={ind} >\n                                                <td style={{ left: 0, position: \"sticky\", backgroundColor: \"#1a8cff\" }} >\n                                                    <div style={{ fontWeight: 'bold', color: \"#fff\", width: 300 }} >\n                                                        {findVariableName(elem) === false ? elem : (findVariableName(elem) + \"\\n(\" + findVariableUnit(elem) + \")\")}\n                                                    </div>\n                                                </td>\n                                                {\n                                                    this.state.finale.map((_el) => (\n                                                        _el.values.map((el, i) => (\n                                                            <td onClick={() => { this.setState({ current: { id: i, variable: elem } }) }} style={{ cursor: \"pointer\", backgroundColor: (i === this.state.current.id || elem === this.state.current.variable) && \"#70b7ff\" }} key={i} >{el.values[elem] === \"-\" ? \"N/A\" : findGroup(elem, el.values[elem])}</td>\n                                                        ))\n                                                    ))\n                                                }\n                                            </tr>\n                                        ))\n                                    }\n                                </tbody>\n                            </table>\n                            <Typography style={{ textAlign: 'left', marginLeft: '2%' }} >{\"Showing 1 to \" + this.state.keys.length + \" of \" + this.state.keys.length + \" pages\"}</Typography>\n                        </div>\n                    }\n                </div >\n            </div >\n        )\n    }\n}\n\nconst styles = {\n    selector: {\n        displey: \"flex\",\n        flexDirection: 'row',\n        margin: 15\n    }\n}\n\nexport default Main;"]},"metadata":{},"sourceType":"module"}